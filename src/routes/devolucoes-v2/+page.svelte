<!--
  Devolu√ß√µes v2 - Sistema Avan√ßado de Devolu√ß√µes
  
  Sistema completo de gerenciamento de devolu√ß√µes com:
  - Status COM_COLABORADOR/DEVOLVIDO
  - Limita√ß√µes por assinatura digital
  - Workflow de aprova√ß√£o
  - Valida√ß√£o de condi√ß√µes do equipamento
  - Event Sourcing para auditoria completa
-->

<script lang="ts">
  import { onMount } from 'svelte';
  import { page } from '$app/stores';
  import DevolutionDashboard from '$lib/components/devolution/DevolutionDashboard.svelte';
  import { 
    Breadcrumb, 
    BreadcrumbItem,
    Alert
  } from 'flowbite-svelte';
  import { 
    HomeOutline,
    ArrowLeftOutline,
    CheckCircleOutline
  } from 'flowbite-svelte-icons';

  // Estado da p√°gina
  let pageLoaded = false;

  onMount(() => {
    console.log('üöÄ P√°gina Devolu√ß√µes v2 inicializada');
    console.log('üìã Sistema avan√ßado de devolu√ß√µes carregado');
    console.log('üîÑ Features implementadas:');
    console.log('  - Status COM_COLABORADOR/DEVOLVIDO');
    console.log('  - Limita√ß√µes por assinatura digital');
    console.log('  - Workflow de aprova√ß√£o com m√∫ltiplas etapas');
    console.log('  - Valida√ß√£o autom√°tica de devolu√ß√µes');
    console.log('  - Event Sourcing para auditoria completa');
    console.log('  - Tracking de tempo de posse');
    console.log('  - Valida√ß√£o de condi√ß√µes do equipamento');
    
    pageLoaded = true;
  });
</script>

<svelte:head>
  <title>Devolu√ß√µes Avan√ßadas - DataLife EPI</title>
  <meta name="description" content="Sistema avan√ßado de devolu√ß√µes com workflow de aprova√ß√£o e valida√ß√£o autom√°tica" />
</svelte:head>

<div class="min-h-screen bg-gray-50 dark:bg-gray-900">
  <!-- Breadcrumb -->
  <div class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
      <Breadcrumb solid class="mb-0">
        <BreadcrumbItem href="/" home>
          <HomeOutline class="w-4 h-4 mr-2" />
          Dashboard
        </BreadcrumbItem>
        <BreadcrumbItem>
          <ArrowLeftOutline class="w-4 h-4 mr-2" />
          Devolu√ß√µes Avan√ßadas
        </BreadcrumbItem>
      </Breadcrumb>
    </div>
  </div>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <!-- Header com informa√ß√µes sobre o sistema -->
    <div class="mb-8">
      <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg p-6 shadow-lg">
        <div class="flex items-center gap-3 mb-4">
          <ArrowLeftOutline class="w-8 h-8" />
          <div>
            <h1 class="text-3xl font-bold">Sistema Avan√ßado de Devolu√ß√µes</h1>
            <p class="text-blue-100 mt-1">
              Controle completo do ciclo de vida dos EPIs com workflow inteligente
            </p>
          </div>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
          <div class="bg-white/10 rounded-lg p-4">
            <div class="flex items-center gap-2 mb-2">
              <CheckCircleOutline class="w-5 h-5" />
              <span class="font-semibold">Valida√ß√£o Autom√°tica</span>
            </div>
            <p class="text-sm text-blue-100">
              Sistema verifica automaticamente se devolu√ß√µes podem ser processadas baseado em regras de neg√≥cio
            </p>
          </div>
          
          <div class="bg-white/10 rounded-lg p-4">
            <div class="flex items-center gap-2 mb-2">
              <CheckCircleOutline class="w-5 h-5" />
              <span class="font-semibold">Workflow de Aprova√ß√£o</span>
            </div>
            <p class="text-sm text-blue-100">
              Processo estruturado com m√∫ltiplas assinaturas e aprova√ß√µes conforme criticidade do equipamento
            </p>
          </div>
          
          <div class="bg-white/10 rounded-lg p-4">
            <div class="flex items-center gap-2 mb-2">
              <CheckCircleOutline class="w-5 h-5" />
              <span class="font-semibold">Event Sourcing</span>
            </div>
            <p class="text-sm text-blue-100">
              Auditoria completa com hist√≥rico de todas as movimenta√ß√µes e mudan√ßas de status
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Alertas informativos -->
    <div class="space-y-4 mb-8">
      <Alert color="blue" border>
        <CheckCircleOutline slot="icon" class="w-5 h-5" />
        <span class="font-medium">Sistema Implementado:</span> 
        Todas as funcionalidades do sistema avan√ßado de devolu√ß√µes est√£o implementadas e prontas para integra√ß√£o com o backend.
      </Alert>
      
      <Alert color="green" border>
        <CheckCircleOutline slot="icon" class="w-5 h-5" />
        <span class="font-medium">Arquitetura Modular:</span> 
        Utiliza Container/Presenter pattern, service adapters especializados e stores reativos para m√°xima flexibilidade.
      </Alert>
    </div>

    <!-- Dashboard Component -->
    {#if pageLoaded}
      <DevolutionDashboard />
    {:else}
      <div class="flex justify-center items-center py-12">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"></div>
        <span class="ml-3 text-gray-600 dark:text-gray-400">Carregando sistema de devolu√ß√µes...</span>
      </div>
    {/if}
  </div>
</div>

<style>
  /* Custom animations for the gradient background */
  @keyframes gradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  .bg-gradient-to-r {
    background-size: 200% 200%;
    animation: gradient 6s ease infinite;
  }
</style>